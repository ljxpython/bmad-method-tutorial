# BMAD-METHOD Brownfield 快速参考

## 🚀 快速开始

### 基本流程
```bash
# 1. 系统分析
cd /your-project
npx bmad-method flatten --output system-analysis.xml

# 2. AI分析
# 在Web UI中上传XML文件，使用各种代理分析

# 3. 文档化
# 创建系统文档和改进计划

# 4. 分阶段实施
# 按计划渐进式改造系统
```

### 核心原则
- 🎯 **业务价值优先**：技术改造必须服务业务目标
- 🛡️ **风险可控**：每个阶段都要有风险缓解措施  
- 🔄 **渐进实施**：小步快跑，持续改进
- 📊 **数据驱动**：基于数据和事实进行决策

## 📋 检查清单

### 项目启动检查清单
- [ ] 明确业务目标和成功指标
- [ ] 评估现有系统技术债务
- [ ] 识别主要风险和约束条件
- [ ] 组建跨职能项目团队
- [ ] 制定渐进式实施计划
- [ ] 建立监控和反馈机制

### 每个阶段检查清单
- [ ] 阶段目标明确且可衡量
- [ ] 风险缓解措施已就位
- [ ] 回滚方案已准备完毕
- [ ] 测试覆盖率达到要求
- [ ] 文档更新同步完成
- [ ] 干系人沟通到位

## 🔧 常用命令

### BMAD-METHOD命令
```bash
# 完整系统分析
npx bmad-method flatten

# 指定目录分析
npx bmad-method flatten --input ./src

# 性能聚焦分析
npx bmad-method flatten --focus-performance

# 架构聚焦分析  
npx bmad-method flatten --focus-architecture

# 扩展性聚焦分析
npx bmad-method flatten --focus-extensibility
```

### AI代理使用模板
```bash
# 架构师代理
@architect
*analyze-system-architecture
请分析系统的架构设计和技术债务...

# 业务分析师代理
@analyst  
*analyze-business-processes
请分析业务流程和优化机会...

# QA代理
@qa
*assess-system-quality
请评估系统质量和测试策略...

# 开发代理
@dev
*plan-system-refactoring
请制定系统重构计划...

# 项目管理代理
@pm
*create-project-plan
请创建项目实施计划...
```

## ⚠️ 风险控制

### 高风险操作清单
1. **数据库结构变更**
   - ✅ 先备份，后操作
   - ✅ 分步骤执行变更
   - ✅ 验证数据一致性

2. **API接口修改**
   - ✅ 保持向后兼容
   - ✅ 版本控制策略
   - ✅ 客户端兼容性测试

3. **架构重构**
   - ✅ 渐进式拆分
   - ✅ 双写模式验证
   - ✅ 流量灰度切换

4. **部署上线**
   - ✅ 蓝绿部署
   - ✅ 健康检查
   - ✅ 快速回滚准备

### 应急响应
```bash
# 紧急回滚脚本
#!/bin/bash
echo "执行紧急回滚..."

# 1. 停止新版本服务
kubectl scale deployment new-service --replicas=0

# 2. 扩容旧版本服务  
kubectl scale deployment old-service --replicas=5

# 3. 切换流量
kubectl patch service api-service -p '{"spec":{"selector":{"version":"old"}}}'

# 4. 验证服务状态
kubectl get pods -l app=api-service

echo "回滚完成"
```

## 📊 关键指标

### 技术指标
| 指标 | 目标值 | 监控方法 |
|------|--------|----------|
| API响应时间P99 | <1秒 | APM工具 |
| 系统可用性 | >99.9% | 健康检查 |
| 错误率 | <0.1% | 日志分析 |
| 测试覆盖率 | >90% | 代码覆盖工具 |

### 业务指标  
| 指标 | 监控频率 | 数据源 |
|------|----------|--------|
| 用户满意度 | 月度 | 用户调研 |
| 功能使用率 | 日度 | 用户行为分析 |
| 业务流程时长 | 实时 | 业务日志 |
| 客户投诉数 | 日度 | 客服系统 |

## 🛠️ 工具推荐

### 分析工具
- **BMAD-METHOD**：系统分析
- **SonarQube**：代码质量
- **JMeter/K6**：性能测试
- **OWASP ZAP**：安全扫描

### 开发工具
- **Git**：版本控制
- **Docker**：容器化
- **Jenkins/GitHub Actions**：CI/CD
- **Postman**：API测试

### 监控工具
- **Prometheus**：指标收集
- **Grafana**：可视化展示
- **ELK**：日志分析
- **Jaeger**：链路追踪

## 📚 模板资源

### 文档模板
- [系统分析报告模板](templates/system-analysis-template.md)
- [项目计划模板](templates/project-plan-template.md)
- [风险评估模板](templates/risk-assessment-template.md)
- [测试计划模板](templates/test-plan-template.md)

### 代码模板
- [微服务基础架构](templates/microservice-boilerplate/)
- [数据迁移脚本](templates/data-migration-scripts/)
- [监控配置](templates/monitoring-config/)
- [部署脚本](templates/deployment-scripts/)

## 🤔 故障排查

### 常见问题
1. **BMAD分析失败**
   ```bash
   # 检查权限
   ls -la 
   # 检查依赖
   npm list bmad-method
   # 重新安装
   npm install -g bmad-method
   ```

2. **AI代理响应慢**
   - 检查网络连接
   - 减少上传文件大小
   - 分批次处理大型项目

3. **性能测试不准确**
   - 确保测试环境与生产环境一致
   - 预热系统后再开始测试
   - 多次测试取平均值

4. **部署失败**
   - 检查环境变量配置
   - 验证依赖服务状态
   - 查看详细错误日志

### 调试技巧
```bash
# 启用详细日志
export DEBUG=bmad:*

# 查看系统资源使用
htop
df -h
free -m

# 检查网络连接
ping api.bmad-method.com
curl -v https://api.bmad-method.com/health

# 查看应用日志
tail -f /var/log/app/application.log
```

## 📞 获取帮助

### 社区支持
- 📖 [官方文档](https://docs.bmad-method.com)
- 💬 [社区论坛](https://forum.bmad-method.com)
- 🐛 [问题反馈](https://github.com/bmad-method/issues)
- 📺 [视频教程](https://www.youtube.com/bmadmethod)

### 紧急联系
- 🆘 **紧急故障**：contact@bmad-method.com
- 🎓 **培训服务**：training@bmad-method.com
- 🔧 **技术咨询**：consulting@bmad-method.com
- 💼 **商业合作**：business@bmad-method.com

## 🎯 成功要素

### 团队协作
- 明确的角色分工
- 定期的沟通协调
- 及时的问题解决
- 持续的知识分享

### 技术实践
- 自动化的CI/CD流程
- 全面的测试覆盖
- 实时的监控告警
- 快速的问题响应

### 项目管理
- 清晰的目标设定
- 合理的计划安排
- 有效的风险控制
- 持续的进度跟踪

---

*💡 **提示**：这个快速参考是你在Brownfield项目中的得力助手。建议打印出来贴在显眼的地方，或者添加到浏览器书签中，随时查阅使用。记住：好的工具和方法只有在实践中才能发挥价值！*